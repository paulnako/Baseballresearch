points(power$datetime, power$Sub_metering_3, type = "l", col = "blue")
legend("topright", legend = c("Sub_metering_1", "Sub_metering_2",
"Sub_metering_3"),
col = c("black", "red", "blue"), lty = c(1, 1, 1), bty = "n")
}
plot4b <- plot(power$datetime, power$Global_reactive_power, type = "l",
xlab = "datetime")
if(!file.exists("./NEI")){dir.create("./NEI")}
fileurl <- "https://d396qusza40orc.cloudfront.net/exdata%2Fdata%2FNEI_data.zip"
if(!file.exists("./data/exdata_data_NEI_data.zip"))
{download.file(fileurl, destfile = "./data/exdata_data_NEI_data.zip",
method = "curl")
datedownloaded <- date()
unzipped.data <- unzip("./data/exdata_data_NEI_data.zip")
NEI <- readRDS("summarySCC_PM25.rds")
SCC <- readRDS("Source_Classification_Code.rds")
setwd("~/Desktop/R")
if(!file.exists("./NEI")){dir.create("./NEI")}
fileurl <- "https://d396qusza40orc.cloudfront.net/exdata%2Fdata%2FNEI_data.zip"
if(!file.exists("./data/exdata_data_NEI_data.zip"))
{download.file(fileurl, destfile = "./data/exdata_data_NEI_data.zip",
method = "curl")
datedownloaded <- date()
unzipped.data <- unzip("./data/exdata_data_NEI_data.zip")
NEI <- readRDS("summarySCC_PM25.rds")
SCC <- readRDS("Source_Classification_Code.rds")
if(!file.exists("./NEI")){dir.create("./NEI")}
fileurl <- "https://d396qusza40orc.cloudfront.net/exdata%2Fdata%2FNEI_data.zip"
if(!file.exists("./data/exdata_data_NEI_data.zip"))
{download.file(fileurl, destfile = "./data/exdata_data_NEI_data.zip",
method = "curl")}
datedownloaded <- date()
unzipped.data <- unzip("./data/exdata_data_NEI_data.zip")
NEI <- readRDS("summarySCC_PM25.rds")
SCC <- readRDS("Source_Classification_Code.rds")
NEI$type <- as.factor(NEI$type)
if(!file.exists("./NEI")){dir.create("./NEI")}
fileurl <- "https://d396qusza40orc.cloudfront.net/exdata%2Fdata%2FNEI_data.zip"
if(!file.exists("./NEI/exdata_data_NEI_data.zip"))
{download.file(fileurl, destfile = "./NEI/exdata_data_NEI_data.zip",
method = "curl")}
datedownloaded <- date()
unzipped.data <- unzip("./NEI/exdata_data_NEI_data.zip")
NEI <- readRDS("summarySCC_PM25.rds")
SCC <- readRDS("Source_Classification_Code.rds")
if(!file.exists("./NEI")){dir.create("./NEI")}
fileurl <- "https://d396qusza40orc.cloudfront.net/exdata%2Fdata%2FNEI_data.zip"
download.file(fileurl, destfile = "./NEI/exdata_data_NEI_data.zip",
method = "curl")
datedownloaded <- date()
unzipped.data <- unzip("./NEI/exdata_data_NEI_data.zip")
NEI <- readRDS("summarySCC_PM25.rds")
SCC <- readRDS("Source_Classification_Code.rds")
if(!file.exists("./NEI")){dir.create("./NEI")}
fileurl <- "https://d396qusza40orc.cloudfront.net/exdata%2Fdata%2FNEI_data.zip"
download.file(fileurl, destfile = "./data/exdata_data_NEI_data.zip", method = "curl")
datedownloaded <- date()
unzipped.data <- unzip("./data/exdata_data_NEI_data.zip")
NEI <- readRDS("summarySCC_PM25.rds")
SCC <- readRDS("Source_Classification_Code.rds")
x<- 2
if(!file.exists("./NEI")){dir.create("./NEI")}
fileurl <- "https://d396qusza40orc.cloudfront.net/exdata%2Fdata%2FNEI_data.zip"
if(!file.exists("./NEI/exdata_data_NEI_data.zip"))
{download.file(fileurl, destfile = "./NEI/exdata_data_NEI_data.zip",
method = "curl")}
datedownloaded <- date()
unzipped.data <- unzip("./NEI/exdata_data_NEI_data.zip")
NEI <- readRDS("summarySCC_PM25.rds")
SCC <- readRDS("Source_Classification_Code.rds")
require(ggplot2)
library(doBy)
mobile <- grep("onroad", SCC[, 2])
mobile_sources <- SCC[mobile,]
plot5data <- NEI[NEI$SCC == mobile_sources$SCC & NEI$fips == "24510",]
head(NEI)
plot5data <- NEI[NEI$TYPE == ON-ROAD & NEI$fips == "24510",]
plot5data <- NEI[NEI$TYPE == "ON-ROAD" & NEI$fips == "24510",]
plot5data <- NEI[NEI$type == "ON-ROAD" & NEI$fips == "24510",]
plot(plot5data$year, plot5data$Emissions, type = "b", xlab = "Year",
ylab = "Total Emissions (Tons)",
main = "Baltimore City Total Emissions from Motor Vehicle")
plot5data <- summaryBy(Emissions ~ year, data = plot5data, FUN = sum)
plot(plot5data$year, plot5data$Emissions, type = "b", xlab = "Year",
ylab = "Total Emissions (Tons)",
main = "Baltimore City Total Emissions from Motor Vehicle")
plot(plot5data$year, plot5data$Emissions, type = "b", xlab = "Year",
ylab = "Total Emissions (Tons)",
main = "Baltimore City Total Emissions from Motor Vehicle Sources")
plot6data <- plot5data <- NEI[NEI$type == "ON-ROAD" & NEI$fips == "06037",]
View(plot6data)
lines(plot6data$year, plot6data$Emissions, col = "red")
plot5data <- summaryBy(Emissions ~ year, data = plot5data, FUN = sum)
plot(plot5data$year, plot5data$Emissions, type = "b", xlab = "Year",
ylab = "Total Emissions (Tons)",
main = "Baltimore City Total Emissions from Motor Vehicle Sources")
plot5data <- NEI[NEI$type == "ON-ROAD" & NEI$fips == "24510",]
plot(plot5data$year, plot5data$Emissions, type = "b", xlab = "Year",
ylab = "Total Emissions (Tons)",
main = "Baltimore City Total Emissions from Motor Vehicle Sources")
plot5data <- summaryBy(Emissions ~ year, data = plot5data, FUN = sum)
plot(plot5data$year, plot5data$Emissions, type = "b", xlab = "Year",
ylab = "Total Emissions (Tons)",
main = "Baltimore City Total Emissions from Motor Vehicle Sources")
plot6data <- summaryBy(Emissions ~ year, data = plot6data, FUN = sum)
lines(plot6data$year, plot6data$Emissions, col = "red")
lines(plot6data$year, plot6data$Emissions, col = "red")
lines(plot5data$year, plot6data$Emissions, col = "red")
plot(plot5data$year, plot5data$Emissions, type = "b", xlab = "Year",
ylab = "Total Emissions (Tons)",
main = "Baltimore City Total Emissions from Motor Vehicle Sources")
lines(plot5data$year, plot6data$Emissions, col = "red")
lines(plot5data$year, plot6data$Emissions, col = "red")
par(new = TRUE)
plot(plot6data$year, plot6data$Emissions, type = "b")
plot(plot6data$year, plot6data$Emissions, type = "b", xlab = "", ylab ="", col = "red")
plot(plot5data$year, plot5data$Emissions, type = "b", xlab = "Year",
ylab = "Total Emissions (Tons)",
main = "Baltimore City Total Emissions from Motor Vehicle Sources")
par(new = TRUE)
plot(plot6data$year, plot6data$Emissions, type = "b", xlab = "", ylab ="",
col = "red")
plot(plot5data$year, plot5data$Emissions, type = "b", xlab = "Year",
ylab = "Total Emissions (Tons)",
main = "Baltimore City Total Emissions from Motor Vehicle Sources")
par(new = TRUE)
plot(plot6data$year, plot6data$Emissions, type = "b", xlab = "", ylab ="",
col = "red", axes = FALSE)
plot(plot5data$year, log(plot5data$Emissions), type = "b", xlab = "Year",
ylab = "Total Emissions (Tons)",
main = "Baltimore City Total Emissions from Motor Vehicle Sources")
par(new = TRUE)
plot(plot6data$year, log(plot6data$Emissions), type = "b", xlab = "", ylab ="",
col = "red", axes = FALSE)
log(plot6data$Emissions
log(plot6data$Emissions)
log(plot6data$Emissions)
?lines
plot(plot5data$year, plot5data$Emissions, type = "b", xlab = "Year",
ylab = "Total Emissions (Tons)",
main = "Baltimore City Total Emissions from Motor Vehicle Sources")
lines(plot6data$Emissions, col = "red")
lines(plot6data$Emissions, col = "red")
?lines
lines(plot6data$Emissions, col = "red")
?merge
merged <- merge(plot5data, plot6data, all = TRUE)
plot6data <- summaryBy(Emissions ~ year | fips, data = plot6data, FUN = sum)
plot6data <- plot5data <- NEI[NEI$type == "ON-ROAD" & NEI$fips == "06037",]
plot6data <- summaryBy(Emissions ~ year | fips, data = plot6data, FUN = sum)
View(plot6data)
plot5data <- summaryBy(Emissions ~ year | fips, data = plot5data, FUN = sum)
mobile <- grep("onroad", SCC[, 2])
mobile_sources <- SCC[mobile,]
plot5data <- NEI[NEI$type == "ON-ROAD" & NEI$fips == "24510",]
plot5data <- summaryBy(Emissions ~ year | fips, data = plot5data, FUN = sum)
plot6data <- plot5data <- NEI[NEI$type == "ON-ROAD" & NEI$fips == "06037",]
plot6data <- summaryBy(Emissions ~ year | fips, data = plot6data, FUN = sum)
merged <- merge(plot5data, plot6data, all = TRUE)
plot5data <- summaryBy(Emissions ~ year | fips, data = plot5data, FUN = sum)
merged <- merge(plot5data, plot6data, all = TRUE)
View(merged)
View(plot5data)
View(plot6data)
View(plot5data)
View(plot6data)
plot5data <- NEI[NEI$type == "ON-ROAD" & NEI$fips == "24510",]
plot5data <- summaryBy(Emissions ~ year | fips, data = plot5data, FUN = sum)
plot6data <- plot5data <- NEI[NEI$type == "ON-ROAD" & NEI$fips == "06037",]
plot6data <- summaryBy(Emissions ~ year | fips, data = plot6data, FUN = sum)
merged <- merge(plot5data, plot6data, all = TRUE)
plot5data <- NEI[NEI$type == "ON-ROAD" & NEI$fips == "24510",]
plot5data <- summaryBy(Emissions ~ year | fips, data = plot5data, FUN = sum)
plot6data <- NEI[NEI$type == "ON-ROAD" & NEI$fips == "06037",]
plot6data <- summaryBy(Emissions ~ year | fips, data = plot6data, FUN = sum)
View(plot6data)
View(plot5data)
merged <- merge(plot5data, plot6data, all = TRUE)
View(merged)
plot6 <- ggplot(merged, aes(x = merged$year,
y = merged$Emissions.sum, colour = fips)) +
labs(title = "Total Motor Vehicle Emissions in Baltimore City and Los Angeles County",
x = "Year",
y = "Total Emissions (Tons)") +
geom_line() + scale_colour_manual( breaks = unique(merged$fips),
values = c("black", "red"))
plot6
plot6 <- ggplot(merged, aes(x = merged$year,
y = log(merged$Emissions.sum), colour = fips)) +
labs(title = "Total Motor Vehicle Emissions in Baltimore City and Los Angeles County",
x = "Year",
y = "Total Emissions (Tons)") +
geom_line() + scale_colour_manual( breaks = unique(merged$fips),
values = c("black", "red"))
plot6
View(merged)
?apply
for (i in plot5data%Emissions.sum) {
plot5data%pct[i] <- (plot5data%Emissions.sum[i+1]/plot5data%Emissions.sum[i]) -1
}
plot5data%pct[i] <- ((plot5data%Emissions.sum[i+1]/plot5data%Emissions.sum[i]) -1)
for (i in plot5data%Emissions.sum) {
plot5data%pct[i] <- ((plot5data%Emissions.sum[i+1]/plot5data%Emissions.sum[i]) -1)
}
require("quantmod")
plot6 <- ggplot(merged, aes(x = merged$year,
y = delt(merged$Emissions.sum), colour = fips)) +
labs(title = "Total Motor Vehicle Emissions in Baltimore City and Los Angeles County",
x = "Year",
y = "Total Emissions (Tons)") +
geom_line() + scale_colour_manual( breaks = unique(merged$fips),
values = c("black", "red"))
plot6
delt(merged$Emissions.sum)
Delt(merged$Emissions.sum)
plot6 <- ggplot(merged, aes(x = merged$year,
y = delt(merged$Emissions.sum), colour = fips)) +
labs(title = "Total Motor Vehicle Emissions in Baltimore City and Los Angeles County",
x = "Year",
y = "Total Emissions (Tons)") +
geom_line() + scale_colour_manual(breaks = unique(merged$fips),
values = c("black", "red"))
plot6
plot6 <- ggplot(merged, aes(x = merged$year,
y = Delt(merged$Emissions.sum), colour = fips)) +
labs(title = "Total Motor Vehicle Emissions in Baltimore City and Los Angeles County",
x = "Year",
y = "Total Emissions (Tons)") +
geom_line() + scale_colour_manual(breaks = unique(merged$fips),
values = c("black", "red"))
plot6
plot6 <- ggplot(merged, aes(x = merged$year,
y = Delt(merged$Emissions.sum), colour = fips)) +
labs(title = "Total Motor Vehicle Emissions in Baltimore City and Los Angeles County",
x = "Year",
y = "Total Emissions (Tons)") +
geom_line() + scale_colour_manual( breaks = unique(merged$fips),
values = c("black", "red"))
plot6
geom_line()
?geom_line()
plot6 <- ggplot(merged, aes(x = merged$year,
y = Delt(merged$Emissions.sum), colour = fips)) +
labs(title = "Total Motor Vehicle Emissions in Baltimore City and Los Angeles County",
x = "Year",
y = "Total Emissions (Tons)") +
#geom_line() +
scale_colour_manual( breaks = unique(merged$fips),
values = c("black", "red"))
plot6
plot6 <- ggplot(merged, aes(x = merged$year,
y = Delt(merged$Emissions.sum), colour = fips)) +
labs(title = "Total Motor Vehicle Emissions in Baltimore City and Los Angeles County",
x = "Year",
y = "Total Emissions (Tons)") +
geom_line() + scale_colour_manual( breaks = unique(merged$fips),
values = c("black", "red"))
plot6
plot5data$delt <- Delt(plot5data$Emissions.sum)
View(plot5data)
View(plot5data)
mobile <- grep("onroad", SCC[, 2])
mobile_sources <- SCC[mobile,]
plot5data <- NEI[NEI$type == "ON-ROAD" & NEI$fips == "24510",]
plot5data <- summaryBy(Emissions ~ year | fips, data = plot5data, FUN = sum)
plot5data$delt <- Delt(plot5data$Emissions.sum)
plot6data <- NEI[NEI$type == "ON-ROAD" & NEI$fips == "06037",]
plot6data <- summaryBy(Emissions ~ year | fips, data = plot6data, FUN = sum)
plot6data$delt <- Delt(plot6data$Emissions.sum)
merged <- merge(plot5data, plot6data, all = TRUE)
merged[is.na(merged)] <- 0
View(merged)
plot6 <- ggplot(merged, aes(x = merged$year,
y = merged$delt, colour = fips)) +
labs(title = "Total Motor Vehicle Emissions in Baltimore City and Los Angeles County",
x = "Year",
y = "Total Emissions (Tons)") +
geom_line() + scale_colour_manual( breaks = unique(merged$fips),
values = c("black", "red"))
plot6
plot6 <- ggplot(merged, aes(x = merged$year,
y = merged$delt, colour = fips)) +
labs(title = "Total Motor Vehicle Emissions in Baltimore City and Los Angeles County",
x = "Year",
y = "Total Emissions (Tons)") + geom_line() + scale_colour_manual( breaks = unique(merged$fips),
values = c("black", "red"))
plot6
plot5data[is.na(plot5data)] <- 0
plot6data[is.na(plot6data)] <- 0
View(plot6data)
plot6 <- plot(plot6data$year, plot6data$delt)
lines(plot5data$delt)
lines(plot5data$delt, plot5data$year)
plot6 <- plot(plot6data$year, plot6data$delt)
lines(plot5data$delt, plot5data$year)
plot6 <- ggplot(merged, aes(x = merged$year,
y = merged$delt, colour = fips)) +
labs(title = "Total Motor Vehicle Emissions in Baltimore City and Los Angeles County",
x = "Year",
y = "Total Emissions (Tons)") + geom_line() + scale_colour_manual( breaks = unique(merged$fips),
values = c("black", "red"))
plot6
?geom_line
plot6 <- ggplot(merged, aes(x = merged$year,
y = as.integer(merged$delt), colour = fips)) +
labs(title = "Total Motor Vehicle Emissions in Baltimore City and Los Angeles County",
x = "Year",
y = "Total Emissions (Tons)") + geom_line() + scale_colour_manual( breaks = unique(merged$fips),
values = c("black", "red"))
plot6
View(merged)
merged <- merge(plot5data, plot6data, all = TRUE)
merged[is.na(merged)] <- 0
merged$delt <- as.integer(merged$delt)
View(merged)
plot5data <- NEI[NEI$type == "ON-ROAD" & NEI$fips == "24510",]
plot5data <- summaryBy(Emissions ~ year | fips, data = plot5data, FUN = sum)
plot5data$delt <- Delt(plot5data$Emissions.sum)
plot5data[is.na(plot5data)] <- 0
plot6data <- NEI[NEI$type == "ON-ROAD" & NEI$fips == "06037",]
plot6data <- summaryBy(Emissions ~ year | fips, data = plot6data, FUN = sum)
plot6data$delt <- Delt(plot6data$Emissions.sum)
plot6data[is.na(plot6data)] <- 0
merged <- merge(plot5data, plot6data, all = TRUE)
merged$delt <- as.integer(merged$delt)
View(merged)
View(plot5data)
merged <- merge(plot5data, plot6data, all = TRUE)
merged$delt <- as.integer(merged$delt)
merged <- merge(plot5data, plot6data, all = TRUE)
plot6 <- ggplot(merged, aes(x = merged$year,
y = as.integer(merged$delt), colour = fips)) +
labs(title = "Total Motor Vehicle Emissions in Baltimore City and Los Angeles County",
x = "Year",
y = "Total Emissions (Tons)") + geom_line() + scale_colour_manual( breaks = unique(merged$fips),
values = c("black", "red"))
plot6
plot6 <- ggplot(merged, aes(x = merged$year,
y = merged$delt, colour = fips)) +
labs(title = "Total Motor Vehicle Emissions in Baltimore City and Los Angeles County",
x = "Year",
y = "Total Emissions (Tons)") + geom_line() + scale_colour_manual( breaks = unique(merged$fips),
values = c("black", "red"))
plot6
mergdedelt <- merged$delt
plot6 <- ggplot(merged, aes(x = merged$year,
y = mergeddelt, colour = fips)) +
labs(title = "Total Motor Vehicle Emissions in Baltimore City and Los Angeles County",
x = "Year",
y = "Total Emissions (Tons)") + geom_line() + scale_colour_manual( breaks = unique(merged$fips),
values = c("black", "red"))
plot6
mergdedelt <- merged$delt
plot6 <- ggplot(merged, aes(x = merged$year,
y = mergeddelt, colour = fips)) +
labs(title = "Total Motor Vehicle Emissions in Baltimore City and Los Angeles County",
x = "Year",
y = "Total Emissions (Tons)") + geom_line() + scale_colour_manual( breaks = unique(merged$fips),
values = c("black", "red"))
plot6
mergeddelt <- merged$delt
plot6 <- ggplot(merged, aes(x = merged$year,
y = mergeddelt, colour = fips)) +
labs(title = "Total Motor Vehicle Emissions in Baltimore City and Los Angeles County",
x = "Year",
y = "Total Emissions (Tons)") + geom_line() + scale_colour_manual( breaks = unique(merged$fips),
values = c("black", "red"))
plot6
plot6 <- ggplot(merged, aes(x = merged$year,
y = merged$delt, colour = fips)) +
labs(title = "Total Motor Vehicle Emissions in Baltimore City and Los Angeles County",
x = "Year",
y = "Total Emissions (Tons)") + geom_line() + scale_colour_manual( breaks = unique(merged$fips),
values = c("black", "red"))
plot6
plot6 <- ggplot(merged, aes(x = merged$year,
y = merged$Emissions, colour = fips)) +
labs(title = "Total Motor Vehicle Emissions in Baltimore City and Los Angeles County",
x = "Year",
y = "Total Emissions (Tons)") + geom_line() + scale_colour_manual( breaks = unique(merged$fips),
values = c("black", "red"))
plot6
View(merged)
View(merged)
plot6 <- ggplot(merged, aes(x = merged$year,
y = merged$Emissions.sum, colour = fips)) +
labs(title = "Total Motor Vehicle Emissions in Baltimore City and Los Angeles County",
x = "Year",
y = "Total Emissions (Tons)") + geom_line() + scale_colour_manual( breaks = unique(merged$fips),
values = c("black", "red"))
plot6
plot6 <- ggplot(merged, aes(x = merged$year,
y = log(merged$Emissions.sum), colour = fips)) +
labs(title = "Total Motor Vehicle Emissions in Baltimore City and Los Angeles County",
x = "Year",
y = "Total Emissions (Tons)") + geom_line() + scale_colour_manual( breaks = unique(merged$fips),
values = c("black", "red"))
plot6
plot6 <- ggplot(merged, aes(x = merged$year,
y = merged$Emissions.sum, colour = fips)) +
labs(title = "Total Motor Vehicle Emissions in Baltimore City and Los Angeles County",
x = "Year",
y = "Total Emissions (Tons)") + geom_line() + scale_colour_manual( breaks = unique(merged$fips),
values = c("black", "red"))
plot6
setwd("~/Desktop/R/Baseball/Baseballresearch")
###Read "Batting", "Master", and fielding tables from Lahman Database
fielding <- read.csv("./Lahman/fielding.csv")
master <- read.csv("./Lahman/master.csv")
batting <- read.csv("./Lahman/batting.csv")
###Merge to include player position, names
matting <- merge(master, batting, by = "playerID")
data <- merge(matting, fielding[, c("playerID", "POS")], by = "playerID")
##Position players post-1955
data <- data[data$yearID >= 1955 & data$POS != "P",]
###Add age, k%, BB%, HR%
data$name <- paste(data$nameFirst, data$nameLast, sep = " ")
data$age <- with(data, yearID - birthYear)
data$PA <- with(data, AB + BB + IBB + HBP + SH + SF, na.rm = TRUE)
data$Kpct <- with(data, SO/PA, na.rm = TRUE)
data$BBpct <- with(data, BB/PA, na.rm = TRUE)
data$HRpct <- with(data, HR/PA, na.rm = TRUE)
###Clean up data frame
clean <- data[,c("playerID", "name", "yearID", "age", "PA", "SO", "BB",
"HR","Kpct","BBpct", "HRpct")]
###League Averages
LeagueAvgs <- data.frame(1955:2013,
tapply(data$Kpct, data$yearID, mean, na.rm = TRUE),
tapply(data$BBpct, data$yearID, mean, na.rm = TRUE),
tapply(data$HRpct, data$yearID, mean, na.rm = TRUE))
colnames(LeagueAvgs) <- c("year", "Kpct", "BBpct", "HRpct")
###Add K+, BB+, HR+
final <- clean[c("name", "yearID", "age", "PA", "Kpct", "BBpct", "HRpct")]
final <- final[!duplicated(final),]
final$Kplus <- 1:length(final$yearID)
final$BBplus <- 1:length(final$yearID)
final$HRplus <- 1:length(final$yearID)
FUNfinal <- final[final$age == 30,]
for (i in 1:length(FUNfinal$yearID)){
FUNfinal$Kplus[i] <- round((
FUNfinal$Kpct[i] / LeagueAvgs$Kpct[LeagueAvgs$year == FUNfinal$yearID[i]]) * 100)
FUNfinal$BBplus[i] <- round((
FUNfinal$BBpct[i] / LeagueAvgs$BBpct[LeagueAvgs$year == FUNfinal$yearID[i]]) * 100)
FUNfinal$HRplus[i] <- round((
FUNfinal$HRpct[i] / LeagueAvgs$HRpct[LeagueAvgs$year == FUNfinal$yearID[i]]) * 100)
}
head(FUNfinal)
View(LeagueAvgs)
comp <- function(name, age, margin){
FUNfinal <- final[final$age == age,]
for (i in 1:length(FUNfinal$yearID)){
FUNfinal$Kplus[i] <- round((
FUNfinal$Kpct[i] / LeagueAvgs$Kpct[LeagueAvgs$year == FUNfinal$yearID[i]]) * 100)
FUNfinal$BBplus[i] <- round((
FUNfinal$BBpct[i] / LeagueAvgs$BBpct[LeagueAvgs$year == FUNfinal$yearID[i]]) * 100)
FUNfinal$HRplus[i] <- round((
FUNfinal$HRpct[i] / LeagueAvgs$HRpct[LeagueAvgs$year == FUNfinal$yearID[i]]) * 100)
}
FUNfinal <- final[c("name", "yearID", "age", "PA", "Kplus", "BBplus", "HRplus")]
finalcomp <-  FUNfinal[FUNfinal$Kplus >= margin - FUNfinal$Kplus[FUNfinal$name == name] &
FUNfinal$Kplus <= margin + FUNfinal$Kplus[FUNfinal$name == name] &
FUNfinal$BBplus >= margin - FUNfinal$BBplus[FUNfinal$name == name] &
FUNfinal$BBplus <= margin + FUNfinal$BBplus[FUNfinal$name == name] &
FUNfinal$HRplus >= margin - FUNfinal$HRplus[FUNfinal$name == name] &
FUNfinal$HRplus <= margin + FUNfinal$HRplus[FUNfinal$name == name] &
complete.cases(FUNfinal),]
return(finalcomp)
}
comp("Jose Bautista", 30, 5)
comp <- function(player, yearsOld, margin){
FUNfinal <- final[final$age == yearsOld,]
for (i in 1:length(FUNfinal$yearID)){
FUNfinal$Kplus[i] <- round((
FUNfinal$Kpct[i] / LeagueAvgs$Kpct[LeagueAvgs$year == FUNfinal$yearID[i]]) * 100)
FUNfinal$BBplus[i] <- round((
FUNfinal$BBpct[i] / LeagueAvgs$BBpct[LeagueAvgs$year == FUNfinal$yearID[i]]) * 100)
FUNfinal$HRplus[i] <- round((
FUNfinal$HRpct[i] / LeagueAvgs$HRpct[LeagueAvgs$year == FUNfinal$yearID[i]]) * 100)
}
FUNfinal <- final[c("name", "yearID", "age", "PA", "Kplus", "BBplus", "HRplus")]
finalcomp <-  FUNfinal[FUNfinal$Kplus >= margin - FUNfinal$Kplus[FUNfinal$name == player] &
FUNfinal$Kplus <= margin + FUNfinal$Kplus[FUNfinal$name == player] &
FUNfinal$BBplus >= margin - FUNfinal$BBplus[FUNfinal$name == player] &
FUNfinal$BBplus <= margin + FUNfinal$BBplus[FUNfinal$name == player] &
FUNfinal$HRplus >= margin - FUNfinal$HRplus[FUNfinal$name == player] &
FUNfinal$HRplus <= margin + FUNfinal$HRplus[FUNfinal$name == player] &
complete.cases(FUNfinal),]
return(finalcomp)
}
comp("Jose Bautista", 30, 5)
comp(player = "Jose Bautista", yearsOld = 30, margin = 5)
comp <- function(player, yearsOld, margin){
FUNfinal <- final[final$age == yearsOld]
for (i in 1:length(FUNfinal$yearID)){
FUNfinal$Kplus[i] <- round((
FUNfinal$Kpct[i] / LeagueAvgs$Kpct[LeagueAvgs$year == FUNfinal$yearID[i]]) * 100)
FUNfinal$BBplus[i] <- round((
FUNfinal$BBpct[i] / LeagueAvgs$BBpct[LeagueAvgs$year == FUNfinal$yearID[i]]) * 100)
FUNfinal$HRplus[i] <- round((
FUNfinal$HRpct[i] / LeagueAvgs$HRpct[LeagueAvgs$year == FUNfinal$yearID[i]]) * 100)
}
FUNfinal <- final[c("name", "yearID", "age", "PA", "Kplus", "BBplus", "HRplus")]
finalcomp <-  FUNfinal[FUNfinal$Kplus >= margin - FUNfinal$Kplus[FUNfinal$name == player] &
FUNfinal$Kplus <= margin + FUNfinal$Kplus[FUNfinal$name == player] &
FUNfinal$BBplus >= margin - FUNfinal$BBplus[FUNfinal$name == player] &
FUNfinal$BBplus <= margin + FUNfinal$BBplus[FUNfinal$name == player] &
FUNfinal$HRplus >= margin - FUNfinal$HRplus[FUNfinal$name == player] &
FUNfinal$HRplus <= margin + FUNfinal$HRplus[FUNfinal$name == player] &
complete.cases(FUNfinal),]
return(finalcomp)
}
comp(player = "Jose Bautista", yearsOld = 30, margin = 5)
